AfxFindResourceHandle [afxwin.h] [dllinit.cpp]


AfxLockGlobals [afximpl.h] [afxcrit.cpp]


Critical Section Objects 的使用参考

Win32 and COM Development
System Services
DLLs, Processes, and Threads
SDK Documentation
DLLs, Processes, and Threads
Synchronization
About Synchronization
Critical Section Objects


对话框创建时需要加载 对话框资源模板

MFC默认设定了查找 资源模块 的顺序，由 AfxFindResourceHandle 实现。
1.（非系统）主模块状态量（main module state 全局） 中保存的当前资源模板（句柄） <非系统DLL>
2.（非系统）主模块状态量（main module state 全局） 中保存的资源模板链表（句柄） <非系统DLL> <non-system DLLs>
3.（非系统）主模块状态量（main module state 全局） 中保存的语言资源模板（句柄） 
4.（系统）主模块状态量（main system module state 全局） 中保存的当前资源模板（句柄） 
5.（系统）主模块状态量（main system module state 全局） 中保存的资源模板链表（句柄） <system DLLs>


如何区分系统与非系统模块、DLL ？


Use AfxFindResourceHandle to walk the resource chain and locate a specific resource by resource ID and resource type. 


mfc system dll 


DLLs [C++]


DLL
shared library (functions \ datas \ resources)



MFC DLL ？
Win32 DLL ?  Win32 DLL (non-MFC)


 
Where to add initialization and termination code 

Regular DLL 
 In the DLL's CWinApp object's InitInstance and ExitInstance. 

Extension DLL 
 In the DllMain function generated by the MFC DLL Wizard. 
 
Non-MFC DLL 
 In a function called DllMain that you provide. 


 
non-MFC DLL 
does not use MFC internally
can be called by either MFC or non-MFC
usually using the standard C interface


 


Win32 DLL
C or C++ 
not use the Microsoft Foundation Class (MFC) library
Win32 Application Wizard. 



MFC DLL Wizard. 
DLL is using MFC




EnumProcessModules 

Process Status Helper

Win32 and COM Development
System Services
DLLs, Processes, and Threads
SDK Documentation
DLLs, Processes, and Threads
Process Status API
About PSAPI
Module Information
 



Module32First 

Tool Help Library

Win32 and COM Development
System Services
DLLs, Processes, and Threads
SDK Documentation
DLLs, Processes, and Threads 
Tool Help Library
About Tool Help Functions
Module Walking










